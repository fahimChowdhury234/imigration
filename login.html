<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Imigration</title>
      <link rel="stylesheet" href="./assets/css/bootstrap.min.css" />
      <link rel="stylesheet" href="./assets/css/style.css" />
      <link rel="stylesheet" href="./assets/css/responsive.css" />
   </head>
   <body>
      <main class="main">
         <div class="auth-wrapper">
            <div class="auth-left">
               <h2>Welcome Back!</h2>
               <p>You'll be able to access a range of services with a single username and password. immnz is designed to protect your privacy and security.</p>
               <a class="btn btn__login" target="_blank" href="./registration.html">Sign Up</a>
            </div>
            <div class="auth-right">
               <div class="auth-login">
                  <h2>Log in with immnz</h2>
                  <div class="auth-login-form">
                     <div class="login-input">
                        <label for="username">User Name</label>
                        <input type="text" id="username" name="name" placeholder="User Name" />
                        <div class="error" id="username-error">Username cannot be empty.</div>
                     </div>
                     <div class="login-input">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" placeholder="Password" />
                        <div class="error" id="password-error-length">Password must be at least 8 characters long.</div>
                        <div class="error" id="password-error-uppercase">Password must contain at least one uppercase letter.</div>
                        <div class="error" id="password-error-lowercase">Password must contain at least one lowercase letter.</div>
                        <div class="error" id="password-error-special">Password must contain at least one special character.</div>
                     </div>

                     <div class="login-input d-flex align-items-center gap-3">
                        <button type="button" id="submit-btn" onclick="validateForm()">Sign In</button>
                        <div class="success" id="success-message">Form submitted successfully!</div>
                     </div>
                     <div class="d-lg-none">Haven't account yet? <a href="./registration.html">registration</a> Here</div>
                  </div>
               </div>
            </div>
         </div>
      </main>
      <script src="./assets/js/jquery-3.6.0.min.js"></script>
      <script src="./assets/js/bootstrap.min.js"></script>
      <script>
         async function validateForm() {
            // Get form elements
            const username = document.getElementById("username");
            const password = document.getElementById("password");
            const submitBtn = document.getElementById("submit-btn");

            // Get error elements
            const usernameError = document.getElementById("username-error");
            const passwordError = document.getElementById("password-error");
            const successMessage = document.getElementById("success-message");

            const lengthError = document.getElementById("password-error-length");
            const uppercaseError = document.getElementById("password-error-uppercase");
            const lowercaseError = document.getElementById("password-error-lowercase");
            const specialError = document.getElementById("password-error-special");

            let isValid = true;

            // Username validation
            if (username.value.trim() === "") {
               usernameError.style.display = "block";
               isValid = false;
            } else {
               usernameError.style.display = "none";
            }

            // Password validation

            const hasUpperCase = /[A-Z]/.test(password.value);
            const hasLowerCase = /[a-z]/.test(password.value);
            console.log(hasLowerCase, hasUpperCase);
            const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password.value);
            const hasMinLength = password.value.length >= 8;

            lengthError.style.display = hasMinLength ? "none" : "block";
            uppercaseError.style.display = hasUpperCase ? "none" : "block";
            lowercaseError.style.display = hasLowerCase ? "none" : "block";
            specialError.style.display = hasSpecialChar ? "none" : "block";

            if (!hasMinLength || !hasUpperCase || !hasLowerCase || !hasSpecialChar) {
               isValid = false;
            }
            // If all validations pass
            if (isValid) {
               submitBtn.classList.add("loading");
               submitBtn.disabled = true;

               const data = {
                  username: username.value,
                  password: password.value,
               };
               window.location.href = "visaVerificationQuery.html";
               // try {
               //    const response = await fetch("https://example.com/api/signup", {
               //       method: "POST",
               //       headers: {
               //          "Content-Type": "application/json",
               //       },
               //       body: JSON.stringify(data),
               //    });

               //    if (response.ok) {
               //       successMessage.style.display = "block";
               //       setTimeout(() => {
               //          successMessage.style.display = "none";
               //       }, 5000);
               //    } else {
               //       // Handle server errors
               //       const errorData = await response.json();
               //       console.log(errorData);
               //    }
               // } catch (error) {
               //    console.log(error.message);
               // } finally {
               //    // Remove loading state
               //    submitBtn.classList.remove("loading");
               //    submitBtn.disabled = false;
               // }
            }

            function validatePassword() {
               const password = document.getElementById("password").value;

               const lengthError = document.getElementById("password-error-length");
               const uppercaseError = document.getElementById("password-error-uppercase");
               const lowercaseError = document.getElementById("password-error-lowercase");
               const specialError = document.getElementById("password-error-special");

               const hasUpperCase = /[A-Z]/.test(password);
               const hasLowerCase = /[a-z]/.test(password);
               const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
               const hasMinLength = password.length >= 8;

               lengthError.style.display = hasMinLength ? "none" : "block";
               uppercaseError.style.display = hasUpperCase ? "none" : "block";
               lowercaseError.style.display = hasLowerCase ? "none" : "block";
               specialError.style.display = hasSpecialChar ? "none" : "block";
            }
         }
      </script>
   </body>
</html>
