<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>immigration</title>
      <link rel="stylesheet" href="./assets/css/bootstrap.min.css" />
      <link rel="stylesheet" href="./assets/css/style.css" />
      <link rel="stylesheet" href="./assets/css/responsive.css" />
   </head>
   <body>
      <main class="main">
         <div class="auth-wrapper">
            <div class="auth-left">
               <h2>Welcome Back!</h2>
               <p>You'll be able to access a range of services with a single username and password. immnz is designed to protect your privacy and security.</p>
               <a class="btn btn__login" target="_blank" href="./login.html">Sign In</a>
            </div>
            <div class="auth-right">
               <div class="auth-login">
                  <h2>Set up your account</h2>
                  <div class="auth-login-form">
                     <div class="login-input">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" placeholder="Email" />
                        <div class="error" id="email-error">Please enter a valid email address.</div>
                     </div>
                     <div class="login-input">
                        <label for="username">User Name</label>
                        <input type="text" id="username" name="name" placeholder="User Name" />
                        <div class="error" id="username-error">Username cannot be empty.</div>
                     </div>
                     <div class="login-input">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" placeholder="Password" />
                        <div class="error" id="password-length-error">Password must be at least 8 characters long.</div>
                     </div>
                     <div class="login-input">
                        <label for="confirm-password">Confirm Password</label>
                        <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm Password" />
                        <div class="error" id="password-error">Passwords do not match.</div>
                     </div>
                     <div class="login-input d-flex align-items-center gap-3">
                        <button type="button" id="submit-btn" onclick="validateForm()">Sign Up</button>
                        <div class="success" id="success-message">Registration successfully completed!. Please <a href="./login.html">LogIn Here</a></div>
                     </div>
                     <div class="d-lg-none">Alredy have an account <a href="./login.html">Login</a> Here</div>
                  </div>
               </div>
            </div>
         </div>
      </main>
      <script src="./assets/js/jquery-3.6.0.min.js"></script>
      <script src="./assets/js/bootstrap.min.js"></script>
      <script>
         async function validateForm() {
            // Get form elements
            const email = document.getElementById("email");
            const username = document.getElementById("username");
            const password = document.getElementById("password");
            const confirmPassword = document.getElementById("confirm-password");
            const submitBtn = document.getElementById("submit-btn");
            // Get error elements
            const emailError = document.getElementById("email-error");
            const usernameError = document.getElementById("username-error");
            const passwordLengthError = document.getElementById("password-length-error");
            const passwordError = document.getElementById("password-error");
            const successMessage = document.getElementById("success-message");

            let isValid = true;

            // Email validation
            const emailPattern = /^[^ ]+@[^ ]+\.[a-z]{2,3}$/;
            if (!email.value.match(emailPattern)) {
               emailError.style.display = "block";
               isValid = false;
            } else {
               emailError.style.display = "none";
            }

            // Username validation
            if (username.value.trim() === "") {
               usernameError.style.display = "block";
               isValid = false;
            } else {
               usernameError.style.display = "none";
            }

            // Password length validation
            if (password.value.length < 8) {
               passwordLengthError.style.display = "block";
               isValid = false;
            } else {
               passwordLengthError.style.display = "none";
            }

            // Password match validation
            if (password.value !== confirmPassword.value) {
               passwordError.style.display = "block";
               isValid = false;
            } else {
               passwordError.style.display = "none";
            }

            // If all validations pass
            if (isValid) {
               // If all validations pass
               if (isValid) {
                  submitBtn.classList.add("loading");
                  submitBtn.disabled = true;

                  const data = {
                     email: email.value,
                     username: username.value,
                     password: password.value,
                  };
                  window.location.href = "visaVerificationQuery.html";
                  // try {
                  //    const response = await fetch("https://example.com/api/signup", {
                  //       method: "POST",
                  //       headers: {
                  //          "Content-Type": "application/json",
                  //       },
                  //       body: JSON.stringify(data),
                  //    });

                  //    if (response.ok) {
                  //       successMessage.style.display = "block";
                  //       setTimeout(() => {
                  //          successMessage.style.display = "none";
                  //       }, 5000);
                  //    } else {
                  //       // Handle server errors
                  //       const errorData = await response.json();
                  //       console.log(errorData);
                  //    }
                  // } catch (error) {
                  //    console.log(error.message);
                  // } finally {
                  //    // Remove loading state
                  //    submitBtn.classList.remove("loading");
                  //    submitBtn.disabled = false;
                  // }
               }
            }
         }
      </script>
   </body>
</html>
